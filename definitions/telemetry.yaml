---
version: 1
title: Telemetry Dashboard (Tableau Template)
description: Template for building a Tableau dashboard mirroring the app's KPIs and
  visualizations.

connections:
  ats_connection:
    connection:
      type: jdbc
      url: "{baseUrl}/api/v1/telemetry?from={from}&to={to}&segment={segment}"


models:
  telemetry:
    dataSource: ats_connection
    sql:
      tableName: Telemetry
      columns:

        user_hash:
          dataType: string
          label: User Hash
          role: dimension
          type: nominal
          # This field must be title case and will break TWB; needs investigation
          aggregation: None

        m_epoch_sql_wall_time_avg:
          dataType: real
          label: M Epoch Sql Wall Time Avg
          role: measure
          type: quantitative
          # This field must be title case and will break TWB; needs investigation
          aggregation: Avg

        m_subquery_count_sum:
          dataType: integer
          label: M Subquery Count Sum
          role: measure
          type: quantitative
          aggregation: Sum

        query_hour:
          dataType: datetime
          label: Query Hour
          role: dimension
          type: ordinal
          aggregation: None

worksheets:
  avg_wall_by_userhash:
    title: Avg Wall by UserHash
    model: telemetry
    graphType: bar
    xAxis: user_hash
    yAxis: m_epoch_sql_wall_time_avg

  subquery_count_by_hour:
    title: Subquery Count by Hour
    model: telemetry
    graphType: bar
    xAxis: query_hour
    yAxis: m_subquery_count_sum

  subquery_count_by_hour_2:
    title: Subquery Count by Hour 2
    model: telemetry
    graphType: bar
    xAxis: query_hour
    yAxis: m_subquery_count_sum


dashboards:
  telemetry_overview:
    title: Telemetry Overview
    size:
      width: 1000
      height: 800
      hSegments: 1
      vSegments: 2
    tiles:
    - worksheet: avg_wall_by_userhash
      x: 0
      y: 0
    - worksheet: subquery_count_by_hour_2
      x: 0
      y: 1
