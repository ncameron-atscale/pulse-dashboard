<?xml version='1.0' encoding='utf-8' ?>

<!-- build 20252.25.0818.1050                     -->
<workbook original-version='18.1' source-build='2025.2.2 (20252.25.0818.1050)' source-platform='mac' version='18.1' xmlns:user='http://www.tableausoftware.com/xml/user'>
  <document-format-change-manifest>
    <AccessibleZoneTabOrder />
    <AnimationOnByDefault />
    <AutoCreateAndUpdateDSDPhoneLayouts />
    <MarkAnimation />
    <ObjectModelEncapsulateLegacy />
    <ObjectModelTableType />
    <SchemaViewerObjectModel />
    <SetMembershipControl />
    <SheetIdentifierTracking />
    <WindowsPersistSimpleIdentifiers />
  </document-format-change-manifest>
  <preferences>
    <preference name='ui.encoding.shelf.height' value='24' />
    <preference name='ui.shelf.height' value='26' />
  </preferences>
  <datasources>
    <datasource caption='Telemetry (Telemetry)' inline='true' name='ats_connection' version='18.1'>
      <connection class='federated'>
        <named-connections>
          <named-connection caption='jdbc:postgresql://class-i.training.atscale-se-demo.com:15432/Telemetry' name='genericjdbc.0w0lhpd1d6ifhq10hiwbx0augav7'>
            <connection class='genericjdbc' dbname='atscale' dialect='postgres' jdbcproperties='' jdbcurl='jdbc:postgresql://class-i.training.atscale-se-demo.com:15432/Telemetry' port='15432' schema='Telemetry' server='class-i.training.atscale-se-demo.com' username='admin' warehouse=''>
              <connection-customization class='genericjdbc' enabled='false' version='18.1'>
                <vendor name='genericjdbc' />
                <driver name='postgresql' />
                <customizations>
                  <customization name='CAP_CONNECT_CUSTOM_SQL_WITHOUT_SCHEMA' value='no' />
                  <customization name='CAP_CREATE_TEMP_TABLES' value='no' />
                  <customization name='CAP_CUSTOM_NOSQL' value='no' />
                  <customization name='CAP_EXTRACT_ONLY' value='no' />
                  <customization name='CAP_ISOLATION_LEVEL_READ_COMMITTED' value='no' />
                  <customization name='CAP_ISOLATION_LEVEL_READ_UNCOMMITTED' value='no' />
                  <customization name='CAP_ISOLATION_LEVEL_REPEATABLE_READS' value='no' />
                  <customization name='CAP_ISOLATION_LEVEL_SERIALIZABLE' value='no' />
                  <customization name='CAP_JDBC_BIND_DETECT_ALIAS_CASE_FOLDING' value='no' />
                  <customization name='CAP_JDBC_SUPPRESS_EMPTY_CATALOG_NAME' value='no' />
                  <customization name='CAP_JDBC_SUPPRESS_ENUMERATE_DATABASES' value='no' />
                  <customization name='CAP_JDBC_SUPPRESS_ENUMERATE_SCHEMAS' value='no' />
                  <customization name='CAP_JDBC_SUPPRESS_ENUMERATE_TABLES' value='no' />
                  <customization name='CAP_QUERY_BOOLEXPR_TO_INTEXPR' value='yes' />
                  <customization name='CAP_QUERY_FROM_REQUIRES_ALIAS' value='no' />
                  <customization name='CAP_QUERY_GROUP_ALLOW_DUPLICATES' value='yes' />
                  <customization name='CAP_QUERY_GROUP_BY_ALIAS' value='no' />
                  <customization name='CAP_QUERY_GROUP_BY_DEGREE' value='yes' />
                  <customization name='CAP_QUERY_HAVING_REQUIRES_GROUP_BY' value='no' />
                  <customization name='CAP_QUERY_HAVING_UNSUPPORTED' value='no' />
                  <customization name='CAP_QUERY_JOIN_ACROSS_SCHEMAS' value='no' />
                  <customization name='CAP_QUERY_JOIN_REQUIRES_SCOPE' value='no' />
                  <customization name='CAP_QUERY_NULL_REQUIRES_CAST' value='no' />
                  <customization name='CAP_QUERY_SELECT_ALIASES_SORTED' value='yes' />
                  <customization name='CAP_QUERY_SORT_BY_DEGREE' value='yes' />
                  <customization name='CAP_QUERY_SUBQUERIES' value='yes' />
                  <customization name='CAP_QUERY_SUBQUERIES_WITH_TOP' value='yes' />
                  <customization name='CAP_QUERY_SUBQUERY_QUERY_CONTEXT' value='yes' />
                  <customization name='CAP_QUERY_TOPSTYLE_LIMIT' value='no' />
                  <customization name='CAP_QUERY_TOPSTYLE_ROWNUM' value='no' />
                  <customization name='CAP_QUERY_TOPSTYLE_TOP' value='yes' />
                  <customization name='CAP_QUERY_TOP_0_METADATA' value='no' />
                  <customization name='CAP_QUERY_TOP_N' value='yes' />
                  <customization name='CAP_QUERY_WHERE_FALSE_METADATA' value='no' />
                  <customization name='CAP_SELECT_INTO' value='yes' />
                  <customization name='CAP_SELECT_TOP_INTO' value='yes' />
                  <customization name='CAP_SET_ISOLATION_LEVEL_VIA_ODBC_API' value='no' />
                  <customization name='CAP_SET_ISOLATION_LEVEL_VIA_SQL' value='no' />
                  <customization name='CAP_SUPPRESS_CONNECTION_POOLING' value='no' />
                  <customization name='CAP_SUPPRESS_DISCOVERY_QUERIES' value='no' />
                </customizations>
              </connection-customization>
            </connection>
          </named-connection>
        </named-connections>
        <relation connection='genericjdbc.0w0lhpd1d6ifhq10hiwbx0augav7' name='Telemetry' table='[Telemetry].[Telemetry]' type='table' />
        <metadata-records>

          <%  
            Object.entries(models).forEach(([modelName, model]) => {
              Object.entries(model.sql.columns).forEach(([columnName, column]) => {
            %>
              <metadata-record class='column'>
                <remote-name><%= columnName %></remote-name>
                <local-name>[<%= columnName %>]</local-name>
                <parent-name>[<%= model.sql.tableName %>]</parent-name>
                <remote-alias><%= columnName %></remote-alias>
                <!-- Needs Investigation -->
                <ordinal>10</ordinal>

                <% if (column.dataType == 'string') { %>
                  <remote-type>129</remote-type>
                  <aggregation>Count</aggregation>
                  <local-type>string</local-type>
                  <width>2147483647</width>
                  <cast-to-local-type>true</cast-to-local-type>
                  <collation flag='0' name='binary' />
                  <attributes>
                    <attribute datatype='string' name='TypeIsVarchar'>&quot;true&quot;</attribute>
                  </attributes>

                <% } else if (column.dataType == 'real') { %>
                  <local-type>real</local-type>
                  <remote-type>131</remote-type>
                  <aggregation>Sum</aggregation>
                  <scale>0</scale>

                <% } else if (column.dataType == 'datetime') { %>
                  <local-type>datetime</local-type>
                  <remote-type>135</remote-type>
                  <aggregation>Year</aggregation>

                <% } %>
                <contains-null>true</contains-null>
                <object-id>[Telemetry_66103C44A6E049F582E83DCC62D8C5CD]</object-id>
              </metadata-record>
          <% }) }) %>

        </metadata-records>
      </connection>
      <aliases enabled='yes' />

      <%  
        Object.entries(models).forEach(([modelName, model]) => {
          Object.entries(model.sql.columns).forEach(([columnName, column]) => {
        %>
        <column caption='<%= column.label %>' datatype='<%= column.dataType %>' name='[<%= columnName %>]' role='<%= column.role %>' type='<%= column.type %>' />
      <% }) }) %>

      <layout dim-ordering='alphabetic' measure-ordering='alphabetic' show-structure='true' />
      <semantic-values>
        <semantic-value key='[Country].[Name]' value='&quot;United States&quot;' />
      </semantic-values>
      <object-graph>
        <objects>
          <object caption='Telemetry' id='Telemetry_66103C44A6E049F582E83DCC62D8C5CD'>
            <properties context=''>
              <relation connection='genericjdbc.0w0lhpd1d6ifhq10hiwbx0augav7' name='Telemetry' table='[Telemetry].[Telemetry]' type='table' />
            </properties>
          </object>
        </objects>
      </object-graph>
    </datasource>
  </datasources>
  <worksheets>
    <%
      Object.entries(visuals.worksheets).forEach(([worksheetName, worksheet]) => {
      // =============================================
      // BAR CHART WORKSHEETS
      // Note: Top 10 filtering should be applied manually in Tableau Desktop
      // =============================================
      if (worksheet.graphType == 'bar') { %>
        <worksheet name='<%= worksheet.title %>'>
          <table>
            <view>
              <datasources>
                <datasource name='<%= models[worksheet.model].dataSource %>' />
              </datasources>
              <datasource-dependencies datasource='<%= models[worksheet.model].dataSource %>'>
                <column-instance column='[<%= worksheet.yAxis %>]' 
                  derivation='<%= models[worksheet.model].sql.columns[worksheet.yAxis].aggregation %>' 
                  name='[<%= worksheet.yAxis %>]' pivot='key'
                  type='<%= models[worksheet.model].sql.columns[worksheet.yAxis].type %>' />
                <column caption='<%= models[worksheet.model].sql.columns[worksheet.yAxis].label %>' 
                  datatype='<%= models[worksheet.model].sql.columns[worksheet.yAxis].dataType %>' 
                  name='[<%= worksheet.yAxis %>]' 
                  role='<%= models[worksheet.model].sql.columns[worksheet.yAxis].role %>' 
                  type='<%= models[worksheet.model].sql.columns[worksheet.yAxis].type %>' />

                <column-instance column='[<%= worksheet.xAxis %>]' 
                  derivation='<%= models[worksheet.model].sql.columns[worksheet.xAxis].aggregation %>' 
                  name='[<%= worksheet.xAxis %>]' pivot='key'
                  type='<%= models[worksheet.model].sql.columns[worksheet.xAxis].type %>' />
                <column caption='<%= models[worksheet.model].sql.columns[worksheet.xAxis].label %>' 
                  datatype='<%= models[worksheet.model].sql.columns[worksheet.xAxis].dataType %>' 
                  name='[<%= worksheet.xAxis %>]' 
                  role='<%= models[worksheet.model].sql.columns[worksheet.xAxis].role %>' 
                  type='<%= models[worksheet.model].sql.columns[worksheet.xAxis].type %>' />
              </datasource-dependencies>
              <aggregation value='true' />
            </view>
            <style />
            <panes>
              <pane selection-relaxation-option='selection-relaxation-allow'>
                <view>
                  <breakdown value='auto' />
                </view>
                <mark class='Bar' />
              </pane>
            </panes>
            <rows>[<%= models[worksheet.model].dataSource %>].[<%= worksheet.yAxis %>]</rows>
            <cols>[<%= models[worksheet.model].dataSource %>].[<%= worksheet.xAxis %>]</cols>
          </table>
          <simple-id uuid='{<%= crypto.randomUUID()%>}' />
        </worksheet>
      <% } 
      // =============================================
      // LINE CHART WORKSHEETS (KPIs) - Weekly x-axis granularity
      // =============================================
      else if (worksheet.graphType == 'line') { 
        const xAxisCol = models[worksheet.model].sql.columns[worksheet.xAxis];
        const yAxisCol = models[worksheet.model].sql.columns[worksheet.yAxis];
        // Use Week derivation for datetime columns to show weekly ticks
        const xAxisDerivation = xAxisCol.dataType === 'datetime' ? 'Week' : xAxisCol.aggregation;
      %>
        <worksheet name='<%= worksheet.title %>'>
          <table>
            <view>
              <datasources>
                <datasource name='<%= models[worksheet.model].dataSource %>' />
              </datasources>
              <datasource-dependencies datasource='<%= models[worksheet.model].dataSource %>'>
                <column-instance column='[<%= worksheet.xAxis %>]' 
                  derivation='<%= xAxisDerivation %>' 
                  name='[<%= worksheet.xAxis %>]' pivot='key'
                  type='<%= xAxisCol.type %>' />
                <column caption='<%= xAxisCol.label %>' 
                  datatype='<%= xAxisCol.dataType %>' 
                  name='[<%= worksheet.xAxis %>]' 
                  role='<%= xAxisCol.role %>' 
                  type='<%= xAxisCol.type %>' />

                <column-instance column='[<%= worksheet.yAxis %>]' 
                  derivation='<%= yAxisCol.aggregation %>' 
                  name='[<%= worksheet.yAxis %>]' pivot='key'
                  type='<%= yAxisCol.type %>' />
                <column caption='<%= yAxisCol.label %>' 
                  datatype='<%= yAxisCol.dataType %>' 
                  name='[<%= worksheet.yAxis %>]' 
                  role='<%= yAxisCol.role %>' 
                  type='<%= yAxisCol.type %>' />
              </datasource-dependencies>
              <aggregation value='true' />
            </view>
            <style />
            <panes>
              <pane selection-relaxation-option='selection-relaxation-allow'>
                <view>
                  <breakdown value='auto' />
                </view>
                <mark class='Line' />
              </pane>
            </panes>
            <rows>[<%= models[worksheet.model].dataSource %>].[<%= worksheet.yAxis %>]</rows>
            <cols>[<%= models[worksheet.model].dataSource %>].[<%= worksheet.xAxis %>]</cols>
          </table>
          <simple-id uuid='{<%= crypto.randomUUID()%>}' />
        </worksheet>
      <% }
      // =============================================
      // TEXT WORKSHEETS (Summary Statistics)
      // =============================================
      else if (worksheet.graphType == 'text') { %>
        <worksheet name='<%= worksheet.title %>'>
          <table>
            <view>
              <datasources>
                <datasource name='<%= models[worksheet.model].dataSource %>' />
              </datasources>
              <datasource-dependencies datasource='<%= models[worksheet.model].dataSource %>'>
                <% if (worksheet.xAxis && worksheet.yAxis) { %>
                <column-instance column='[<%= worksheet.xAxis %>]' 
                  derivation='<%= models[worksheet.model].sql.columns[worksheet.xAxis].aggregation %>' 
                  name='[<%= worksheet.xAxis %>]' pivot='key'
                  type='<%= models[worksheet.model].sql.columns[worksheet.xAxis].type %>' />
                <column caption='<%= models[worksheet.model].sql.columns[worksheet.xAxis].label %>' 
                  datatype='<%= models[worksheet.model].sql.columns[worksheet.xAxis].dataType %>' 
                  name='[<%= worksheet.xAxis %>]' 
                  role='<%= models[worksheet.model].sql.columns[worksheet.xAxis].role %>' 
                  type='<%= models[worksheet.model].sql.columns[worksheet.xAxis].type %>' />

                <column-instance column='[<%= worksheet.yAxis %>]' 
                  derivation='<%= models[worksheet.model].sql.columns[worksheet.yAxis].aggregation %>' 
                  name='[<%= worksheet.yAxis %>]' pivot='key'
                  type='<%= models[worksheet.model].sql.columns[worksheet.yAxis].type %>' />
                <column caption='<%= models[worksheet.model].sql.columns[worksheet.yAxis].label %>' 
                  datatype='<%= models[worksheet.model].sql.columns[worksheet.yAxis].dataType %>' 
                  name='[<%= worksheet.yAxis %>]' 
                  role='<%= models[worksheet.model].sql.columns[worksheet.yAxis].role %>' 
                  type='<%= models[worksheet.model].sql.columns[worksheet.yAxis].type %>' />
                <% } else if (worksheet.measures) { 
                  worksheet.measures.forEach((measure, idx) => { %>
                <column-instance column='[<%= measure %>]' 
                  derivation='<%= models[worksheet.model].sql.columns[measure].aggregation %>' 
                  name='[<%= measure %>]' pivot='key'
                  type='<%= models[worksheet.model].sql.columns[measure].type %>' />
                <column caption='<%= models[worksheet.model].sql.columns[measure].label %>' 
                  datatype='<%= models[worksheet.model].sql.columns[measure].dataType %>' 
                  name='[<%= measure %>]' 
                  role='<%= models[worksheet.model].sql.columns[measure].role %>' 
                  type='<%= models[worksheet.model].sql.columns[measure].type %>' />
                <% })} %>
              </datasource-dependencies>
              <aggregation value='true' />
            </view>
            <style>
              <style-rule element='cell'>
                <format attr='text-align' value='center' />
                <format attr='font-size' value='14' />
              </style-rule>
              <style-rule element='label'>
                <format attr='font-size' value='9' />
                <format attr='font-weight' value='bold' />
              </style-rule>
            </style>
            <panes>
              <pane selection-relaxation-option='selection-relaxation-allow'>
                <view>
                  <breakdown value='auto' />
                </view>
                <mark class='Text' />
                <encodings>
                  <text column='<%= worksheet.yAxis ? "[" + models[worksheet.model].dataSource + "].[" + worksheet.yAxis + "]" : "[" + models[worksheet.model].dataSource + "].[" + (worksheet.measures ? worksheet.measures[0] : "") + "]" %>' />
                </encodings>
              </pane>
            </panes>
            <rows></rows>
            <cols><% if (worksheet.xAxis) { %>[<%= models[worksheet.model].dataSource %>].[<%= worksheet.xAxis %>]<% } %></cols>
          </table>
          <simple-id uuid='{<%= crypto.randomUUID()%>}' />
        </worksheet>
      <% } %>
    <% }) %>
  </worksheets>
  
  <dashboards>
    <% Object.entries(visuals.dashboards).forEach(([dashboardName, dashboard]) => { 
      const segmentWidth = dashboard.size.width / dashboard.size.hSegments;
      const segmentHeight = dashboard.size.height / dashboard.size.vSegments;
      let zoneId = 0;
    %>

      <dashboard enable-sort-zone-taborder='true' name='<%= dashboard.title %>'>
        <style>
          <style-rule element='title'>
            <format attr='font-weight' value='bold' />
            <format attr='font-size' value='14' />
          </style-rule>
        </style>
        <size maxheight='<%= dashboard.size.height %>' maxwidth='<%= dashboard.size.width %>' 
            minheight='<%= dashboard.size.height %>' minwidth='<%= dashboard.size.width %>' />
        <zones>

          <zone h='100000' id='<%= zoneId++ %>' type-v2='layout-basic' w='100000' x='0' y='0'>
            <% /* Worksheet Tiles */ %>
            <% dashboard.tiles.forEach((tile) => { 
              const colSpan = tile.colSpan || 1;
              const rowSpan = tile.rowSpan || 1;
            %>
              <zone
                id='<%= zoneId++ %>' 
                name='<%= visuals.worksheets[tile.worksheet].title %>'
                w='<%= colSpan * segmentWidth %>' 
                h='<%= rowSpan * segmentHeight %>' 
                x='<%= tile.x * segmentWidth %>' 
                y='<%= tile.y * segmentHeight %>'/>
            <% }) %>

          </zone>
        </zones>
        <simple-id uuid='{<%= crypto.randomUUID()%>}' />
      </dashboard>
    <% }) %>
  </dashboards>

  <windows>
    <%       Object.entries(visuals.worksheets).forEach(([worksheetName, worksheet]) => { %>
      <window class='worksheet'  name='<%= worksheetName %>'>
        <cards>
          <edge name='left'>
            <strip size='160'>
              <card type='pages' />
              <card type='filters' />
              <card type='marks' />
            </strip>
          </edge>
          <edge name='top'>
            <strip size='2147483647'>
              <card type='columns' />
            </strip>
            <strip size='2147483647'>
              <card type='rows' />
            </strip>
            <strip size='31'>
              <card type='title' />
            </strip>
          </edge>
        </cards>
        <simple-id uuid='{<%= crypto.randomUUID()%>}' />
      </window>
    <% }) %>


    <% Object.entries(visuals.dashboards).forEach(([dashboardName, dashboard]) => { %>
      <window class='dashboard' maximized='true' name='<%= dashboard.title %>'>
        <viewpoints>
          <% dashboard.tiles.forEach((tile, index) => { %>
            <viewpoint name='<%= visuals.worksheets[tile.worksheet].title %>' />
          <% }) %>
        </viewpoints>
        <active id='-1' />
        <simple-id uuid='{<%= crypto.randomUUID()%>}' />
      </window>
    <% }) %>


  </windows>

  <thumbnails/>
</workbook>
